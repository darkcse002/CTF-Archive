from Crypto.Util.number import *
from math import isqrt

# flag = bytes_to_long(open('flag.txt', 'rb').read())
# flag = bytes_to_long(b'helloworlldasdasdasdasdsdddddddd')
# while True:
#     p, q = getPrime(1024), getPrime(1024)
#     N = p * q
#     e = getPrime(64)

#     d = pow(e, -1, N - p - q + 1)
#     # phi = (p-1)(q-1)=N-p-q+1
#     encrypted_flag = pow(flag, e, N)
#     if encrypted_flag % 4 == 0:
#         break

'''
c1 = a^d [N]

c2 = (2*a)^d [N]
   = 2^d.a^d [N]
   = 2^d.c1 [N]

c3 = (4*a)^d [N]
   = 4^d.c1 [n]

c3 = 4^d.c1 + kN   
   
c2 = 2^d.c1 + kN
(c2-k1N)^2/c1^2 = (c3-k2n)/c1
(c2-k1N)^2 =c1(c3-k2N)
c2^2-2c2k1N+k1^2N^2 = c1c3 -c1k2N
c2^2 - c1c3 = N.X
'''
encrypted_flag =  6083589853990730363738108158747159384405363758242538625133277066449229863056818189253284206976323218361976858221592484537753537355886295568084046022031780825527963606685110004869726542012825367247991460494752246048440533476606163061714355118088337751536372207826004663562874458904949982739798324461360609104661638936731827696068385857637432810137467867979386893215569471248757821796443159511461767430207605445697246583361334460888047873405393446318455331658935791969231293446772026953726315200473801247066719959290394946804309228705886986401751085969674200920830802919457335991225676927802982588765823163052237871308
assert encrypted_flag % 4 == 0
# a = 2**1024
c1 = int('332f3d91901696c0443a8f8f471d8756da114e9303cdd2edc2de82e239ac12880434e3320765e5614282736bdaa72cfcc4f36f9610a5e6b84fd19a36c86c78620361bf7989e82e7b88b87689b815fc71da1d4af29ab70e590934e92413032b964a93d6d1e05bb64b0470cd9e1d1fd31a3486aa400d216da22f7a186c6b8095ac21a9c0dfd45bc93ef5d7710f98e29a9858d7de8633bcdccd60417c733033c039f59891ada22cc6a2c7ec6564c9ecdf5e0675777ec7b28b8ec817f71f532ffd4ddee9cb2539188e77da4ab3636d0e6a26b92afad9a23b85337496930299337c98d3c78bdaf0501d9996e61c267493b8c9810faafe12431d3ad7d785111295d6f4',16) #pow(a,d,N)
c2 = int('2d0b0ea2d1872783af1455fffbb35eece1f97ec253c1c4a2354bbf37198b9293b918f795db9629fd45de14e75008a3f467f7538552b7317fe6bab26abbd5c81a3c092ab746d6c3e3badc4c7234839beccd81a9b7e3b7d0069b135f6c67e3a6ec193bdf727409147cf04e319e415fef1f32a0b7dfd8fe4123ad07d0d2b8312a50a3b1250d43567319a33be60e9f3f98137ea3785a268bfb167d7ecf12b37b66e475d1587a58bd337d6c7ca41129ff6fdb59049a7c590b2c53b15902c6e8d6181449b1755917d84e5b4774e7777eee66564e1f53cdb0d79ba4ee17b81d2a5a77a70320da1115cfb998eb2949a7c2016ec20b71d4f2e131efa3c83b6a3c754d1fd3',16) # pow(2*a,d,N)
c3 = int('3ea6793509e0900ec9daea414d4c88ded507283dfead2bbd9f7150a840308222aa8f59c75f814e9b3752f162f2b13c4f03fedb67826add761634c5ae2d6c91a7c35e672aed7275659be1547dbccf4e8d5b4cc7f42c86eccf948109f5b5434a700586ada94296590291b3317388d6c0d21dd99b733658dfcf11345ba07ccbef5dfbe63b253c4ac5ba0155d4d40b6c5603ea7b218eca7b060cd75d99865fe425e751d592485067f2dce3a22e7e78ca685d338865c2e3faff3bd2adfbe224afc5366c132156445a16904df457dbd3b42a867f7f5f3b18d09ac0185418b8665dd274ffe4487d37964bd4c562096f02324a9c973fc6bf43790591e336088edf74bcd9',16) #pow(4*a,d,N)
t1 = c2**2 -c1*c3
# a = 2**1024*3
c1 = int('156d800b5c6f43dbed1a00e37f6ac2ae814803bec8f66c27a47829819d8c16f4c76a132e8351b2ba07854a7e8bbb78248b219916ac56858ce1f8211e7a43dde21f974dec82bcb9a22590c5cbca6cfe57af2d0c89d7e76cc4041900bf672d914f17d193c6102265dadbacd0f8164af96cb139a37d20a490f40b4f54ff902661c85e12dec782f1cd7afeead78657c21fe00ef562da7a5e7ab4496e3280c1a6e2445460acf686d127384d509c51c91d00f96d1a58373b5c34bd4081f350394c3f6d2e7ec717f2501c323d008262c4490ba1b3f5a6050d9697bdaef9c14144d9a786866fe550381619f96864e524166c3dcf4f55bc4755db5e068fd41ef83cddc399',16) # pow(a,d,N)
c2 = int('556e0e4f6488350073241961481ebe05a25c2317efa6f7e50d53211320a05943f203a6925dbaada659d25b9da635327042788b296fac517e6dee3532fd278a920ca6b9822624d92b71bbd9847543813fc26af1adbb9ca266195624ee7aa0f6aab140063ffdec32ad151cdca129b2c435678695aab20bb52d400fb2c3229919b13e0533fdb14251f6bb6419114ac05572d651b91f530bd2eaf44e9e651aa4fdf2d115e56222f9bf85dbfe5020fb89b503424b8fe9669f4b058a473bd1baa9e61c98eb36ee4f0e1d155d265950df3b4138cb5d15c43ec9b2ce5c7aaacc171adcc0caa4811616d14067f17e730c91cdb19b6952b5afd8e15d6c9ae765378fd89508',16) # pow(2*a,d,N)
c3 = int('4e26d057e6af464debc2c2d7c99c3bb5648bf7c661de1b9239db4ac672f20f8aa881bdaea00effe9dc295500b964dd5b64593b4a6ba0d638d8c318b5ca3e17283963a5c2b16e2f42d1d67b3835ff54ca5ce7c5d11cc7562a2d182b6a1a15c8ce161914609b4cc0f35185ac803ed41d42cbb739f040d63fff065c8ee12c0fb2c657efe35a64f0feb0a34813fdca79c1e8cb0b8eccb617b7c4221d5682598672aa6d446fe453faaaff71b07b7fc3332a37bfa59dc26835913ab590edcb5dda689c004bfc8c061ed9132d197bf32977e9f120a9d3659cc27757b3fb0f10b4fda3512a0262dc61a7d4624e8b222d9e06bee58e79734cfc2e4211af131d5ad93fa3b5',16) # pow(4*a,d,N)
t2 = c2**2 -c1*c3
from math import gcd
N = gcd(t1,t2)
'''
p1 = msg*(1/2)^d  [N]
p2 = msg*(1/4)^d  [N]
p3 = msg*2^d [N]
'''
p1 = int('f0d3641c27a5114eb4f01e64b9076773aaf96647dc544505cb1fab5d7406c930363d0aba5d1e3f5ac8a88f2d510d04c18b5d714c0fcb173f30e616924478d4d58d466e8565616716010ced3a8c2c8b7ed0cc5db9dc1ede4b24f6fc9be639b7f71d2ad654bf2fcc6696991410d0e9c6b557c1d06388679d35dbdaf5c139293309814f28d14e9213c0b61e462417c7ea76596521b92492b20e4e1c34413cebabc69fcef8583d74e9bce730fe860d2573ccb6342b99a7d63cbe8fcee766b4eda463b004b86cd892a07f5a95ebfc7e98f17fa6ff85d2abf8cb48df51c509a07dbc6fa3147e2e2d066ca7a5daec997c065f0ed0c67a465bded8c87dca71adb6a8a61',16) #pow(encrypted_flag // 2,d,N)
p2 = int('613828d9dd8409e345cf11439a68c4f2d3fe30e3d4519cbc617c432a697540326284f49686b514fb88d992cd511fe8e4c3840e2a629295f67bdb54a3c3bc88a9a529d514631191a96f061ae4dd899df8ef687f628dd23c4d5b33c29bde49edcebfca0cc9ba6702fa47b3f2a03d90dec8aec287042aaeb2f6f135630e8de46f23854bcfe7b54660eded07bb289a3bcf17cd509d650de8472507357e3cd182ad7c50ec807d40390ff8fb7c951ca11150262fdb274f358b289f3aaf28d17f536d66b4a73809b1b0785f2715844311fb82a960ee1317dfc74e3e66067ad0e05fdb36c2edeab0ba7eb3c543bcd90102e0282afe57b9871d8076c65d308b95e13321',16) # pow(encrypted_flag // 4,d,N)
p3 = int('5f0aacb553e1b534c50bed1c475c753dd4c32d0cbebe437017f32b284c98c0533115a6c74e31bdbf5b99f34d7676fdc6de900e1bba5a27abddf772d7a6f5dbdca5aab846a3b26bc9f9b437bb6de1bf53239da6affb8f51d04e1ef240ac5fb6caa01d7c56fbd917d5c42a834b829f859bda1ee29982f44b93add5f52abf718b06a876d52692e6842818b086253ec3e5f380ed2269109cf0a92993269f10ec45d933126f01e840da38591f41262fbcf3952271d95c7261e9e04b67db58867e13ed4529857dfb70bc67d46cbd37d9865ed24500c24515e250e27f7a7374606a9ddb75cf253243e91a74224b1a66bebb57110471cc0a836bf13256701f122141bc22',16)
print((N//26).bit_length() )
N = N // 5 # idk :D
msg = p1*p3 % N
from gmpy2 import iroot
print(long_to_bytes(iroot(msg,2)[0]))
